# ゲーム木探索

## Links

- 世界四連覇 AI エンジニアがゼロから教えるゲーム木探索入門(thunder さん)
  - https://qiita.com/thun-c/items/058743a25c37c87b8aa4
- 競技プログラミングにおけるゲーム機探索の面白さ(tsukammo さん)
  - https://qiita.com/tsukammo/items/02e8ad2469c5441d2956
- ゲーム木探索技術とコンピュータ将棋への応用
  - https://www.slideshare.net/shogotakeuchi/ss-62415546
- AHC典型解法シリーズ第1弾「モンテカルロ法」(thunder さん)
  - https://qiita.com/thun-c/items/8e7ae0249f1907854763


## ゲームの分類

- 0人ゲーム/1人ゲーム/2人ゲーム/多人数ゲーム
  - ゲームの参加者数による分類
- 完全情報/不完全情報
  - 局面(盤面、状態)がすべてプレイヤーに見えているか、そうでないか
    - トランプなどは、手札を公開しない場合は、相手の手札の情報がわからないため不完全情報
- 確定/非確定
  - 着手以外の確率的に不確定な要素があるかどうか
    - すごろくなどは、状態遷移がサイコロに依存して決まるため非確定的
- ゼロ和/非ゼロ和
  - ゲームの結果が、勝ちを+1、負けを-1、引き分けを0などにしたとき、合計が0となるためゼロ和ゲーム
  - 3人以上でのじゃんけん、など

## ゲーム木

- 局面(盤面、状態)をノード、着手(合法手)をエッジとした有向グラフ
- 局面を、経路が違った場合にすべて区別すれば、これは初期局面をルートノードとした木になる
  - 最終局面はリーフノード
- すべて展開できればよいが、通常、ノード数が膨大なため現実的には難しい
  - そのため、着手の良さや局面の評価、探索手法などの工夫が必要
- また、「ゲーム木」として考えてしまうと、探索方法が限られてしまう
  - 状態に局所性があるなら、部分破壊再構築などできる可能性があり、近傍として局所探索/焼きなまし法など検討できる可能性がある

### 合流/重複局面

- 異なる着手列から同じ局面(重複局面)に至ること
- 合流を考慮する場合、その直前の局面の評価値が違ったりするため、訪問回数などを伝播させるときなど注意が必要
- 局面の重複検知は、Zobrist hashなど
- (合流が多いというのは、着手列よりも状態に注目できる＝文脈があまりない、可能性がある)

## playout

- 「(最初から、または、途中の手から)最後まで手を進める」こと
- 「playout回数」は、playoutを行った回数のこと
- ゲーム木探索などでは、playoutによって、複数の解を生成したり、手の良さの評価に用いたりする
- random playoutは、ランダムに手を選んで最後までゲームを進めること
  - 乱択greedy/乱択山登り的な感じのこと
    - 合法手の集合を決めてその集合内を乱択、盤面の評価がよくなる手の集合を乱択で選んで山を登る
- playoutは、高速にして何回も行うか、評価関数を導入してplayoutの質を高めることで有益な情報として活用できる
  - 通常、random playoutはあまり品質の良い解は得られないことが多いので、量か質でカバー


