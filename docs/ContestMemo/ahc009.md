# モノグサプログラミングコンテスト2022(AtCoder Heuristic Contest 009)
- https://atcoder.jp/contests/ahc009

## 問題概要
- 20*20マスのグリッドがあり、外周には壁があり、隣接マスの間には壁があったりなかったりする
- 左上のあるスタート地点から右下のあるゴール地点に向かって、上下左右(UDLR)からなる命令列に従って移動する
- しかし、毎ターン「確率pで命令を無視して何もしない、確率1-pで指示通りに移動(壁がある場合は移動しない)」という動きをする
- 200ターン以下の命令列を作成し、できるだけゴールまでかかるターンの期待値を最小化せよ

## 時間
4時間

## 解説
(50位まで&発言を見つけられた方のみ)

- [解説(公式)](https://atcoder.jp/contests/ahc009/editorial)
- [writer解(wataさん)](https://twitter.com/wata_orz/status/1507660020963414016)
- [1位terry_u16さん](https://twitter.com/terry_u16/status/1507660599001780226)
    - https://twitter.com/terry_u16/status/1507662503651995650
- [2位square1001さん](https://twitter.com/square10011/status/1507660876110708736)
- [3位hitonanodeさん](https://twitter.com/rsat__m/status/1507663533139718145)
- 4位USAさん
- 5位Nyaanさん
- [6位Psyhoさん](https://twitter.com/FakePsyho/status/1507664421132324869)
- [7位ValGrowthさん](https://twitter.com/ValGrowth/status/1507659973433520132)
- 8位Aquariusさん
- [9位kawateaさん](https://twitter.com/kawatea03/status/1507660902794817537)
- [10位takumi152さん](https://twitter.com/takumi152/status/1507661320367538176)
- [11位c7c7さん](https://twitter.com/C7C7LL/status/1507660174470787073)
- [12位plcherrimさん](https://twitter.com/plcherrim/status/1507663997289451521)
- [13位heno239さん](https://twitter.com/heno_code/status/1507659870123700226)
- 14位krさん
- [15位Bondo416さん](https://twitter.com/bond_cmprog/status/1507659214902407172)
- [16位kozimaさん](https://twitter.com/t33f/status/1507659014636974086)
    - https://twitter.com/t33f/status/1507664894635941889
- [17位tomerunさん](https://twitter.com/tomerun/status/1507659630045921280)
- [18位highjumpさん](https://twitter.com/highjump_425/status/1507662711202926600)
- [19位olpheさん](https://twitter.com/_olphe/status/1507659331638276110)
- [20位ha15さん](https://twitter.com/ha15p/status/1507663493272850433)
- 21位KawattaTaidoさん
- 22位tokuさん
- [23位Shun_PIさん](https://twitter.com/Shun___PI/status/1507659970636292099)
    - https://twitter.com/Shun___PI/status/1507662001824485380
    - https://twitter.com/Shun___PI/status/1507669145231687682
- [24位physics0523さん](https://twitter.com/butsurizuki/status/1507661093166260231)
- [25位noimiさん](https://twitter.com/noimi_kyopro/status/1507659006747512836)
- [26位hoshi524さん](https://twitter.com/hoshi524/status/1507667761350475778)
- [27位iwashi31さん](https://twitter.com/iwashi31/status/1507664742110085121)
- [28位rusaさん](https://twitter.com/rusa6111/status/1507666559669800961)
- [29位nok0さん](https://twitter.com/nok0_kyopro/status/1507658979475828736)
- [30位iaNTUさん](https://twitter.com/iaNTU_/status/1507659307533303812)
- 31位gotantoさん
- [32位Shibungiさん](https://twitter.com/Shibungi_kyopro/status/1507659462165016576)
- 33位mtsdさん
- 34位toameさん
- 35位tanzakuさん
- 36位to_omoT222さん
- 37位nasuoさん
- [38位Hufniumさん](https://twitter.com/Hufnium/status/1507659693678039040)
    - https://twitter.com/Hufnium/status/1507660062332166146
- [39位bowwowforeachさん](https://twitter.com/bowwowforeach/status/1507661031648096263)
- 40位tosca2020さん
- 41位homesentinelさん
- [42位Kyo_s_sさん](https://twitter.com/Kyo_s_s/status/1507658893287358470)
    - https://twitter.com/Kyo_s_s/status/1507659363833761795
- 43位Rafbillさん
- [44位pres1dentさん](https://twitter.com/Preds1dent/status/1507666214687969281)
- 45位nope124さん
- 46位uyasudaさん
- [47位Trineutronさん](https://twitter.com/trineutron/status/1507661736429916162)
- [48位soraieさん](https://twitter.com/soraie_/status/1507669693502406656)
- [49位theory_and_meさん](https://twitter.com/theory_and_me/status/1507659669854363654)
- [50位sumoooruさん](https://twitter.com/sumoooru/status/1507660018547847170)

## Links
- [Twitter hashtag AHC009](https://twitter.com/hashtag/AHC009)
- [kiri8128さん Score-Performanceグラフ](https://twitter.com/kiri8128/status/1507727139902455808)

## 個人的メモ
- ざっくり「初期解を作って、山登り/焼きなましで改善」
- 命令列の前の方の変更は後半の状態にまで影響するので、ビームサーチがよさそうに見えるけど、単純な山登り/焼きなましも有効だった模様
    - 良い解の形が「ざっくり全体を右下に持っていった後、散らばった確率値をできるだけ拾う」感じだった？
- 逆にアドホックなルールとかはあんまり得点に繋がりにくかったっぽい

### 初期解
- BFS(01BFS)やダイクストラで最短路
    - 壁にぶつかるまで/曲がるときに+αなコスト。たどり着けない場合は、確率最大マスから最短移動とか、普通のBFS解を使うとか
- 貪欲(評価値が一番改善する方向とか)
- 右下に行きやすくする
- ビームサーチ

### 近傍
- 1文字ランダム変更/削除/挿入
- 1文字ランダム削除、かつ、ランダム/最後に挿入
- 隣のものを1文字挿入(ダブらせ)
- 2点swap
- 区間反転

### スコア計算/評価関数
- スコアを愚直に計算しても5000～10000回ぐらい回る
    - (毎回1ターン目から計算する必要はなくて、変更したターンより前は再計算省略できる。もし命令列の後半部分の変更が重要ならこの省略はかなり有効そうかも)
- 評価関数として「各マスでの"存在確率*ゴールまでの距離"の合計」とかも
    - https://twitter.com/ValGrowth/status/1507659973433520132
    - https://twitter.com/Shun___PI/status/1507659970636292099
    - https://twitter.com/shun_skycrew/status/1507659445450711042

### ビームサーチ
- 命令列と確率値を保持することで、1ターン目からの再計算が不要
- https://twitter.com/chokudai/status/1507663092418682883
- https://twitter.com/colun/status/1507717580022161410


### 壁にぶつかるまで進む/ダブらせ
- できるだけ塊(高い確率値のマス)で扱いたい気持ち
    - 同じ方向に動き続けて、壁にぶつかってそこで滞留させる感じの動き
- 辛いケース(Seed=14)
    - https://twitter.com/gmeriaog/status/1507667151658037249
    - https://twitter.com/kabipoyo/status/1507667602881282055
    - コの字型のところとかが途中にあると抜け出すのが難しい
    - ゴールに辿り着くのが難しい場合への対処も必要
        - 確率値最大マスから最短路で動くを繰り返す、とか
- ダブらせ
    - https://twitter.com/terry_u16/status/1507665798210281473
    - 命令無視されるのを考慮して何回か実行する

### pによって戦略を変える
- pによって挙動や有効な戦略が違っていたかも？
    - https://twitter.com/square10011/status/1507660876110708736
    - https://twitter.com/ryota_cpp/status/1507660204187389953
    - https://twitter.com/tomerun/status/1507659630045921280

### その他
- 「bool cango[y][x][d] := (y,x)から方向dに移動できるか」で持つと便利
    - https://twitter.com/tomerun/status/1507763835746553859
