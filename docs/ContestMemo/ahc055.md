---
title: AHC055(RECRUIT)
---

# RECRUIT 日本橋ハーフマラソン 2025秋(AHC055)

- https://atcoder.jp/contests/ahc055

<img src="../imgs/ahc055.png" width=300>

## 問題概要

- N(\=200)個の宝箱があり、各宝箱の硬さはH_i、宝箱iには武器iが入っている
- 各宝箱は、硬さが0以下になると開く
- 各宝箱は「素手」か「武器」で攻撃ができる
- 素手で攻撃する場合は、攻撃した宝箱の硬さを1減らす
- 各武器は、耐久値C_i (\=1〜6)があり、攻撃をした場合、耐久値が1減り、攻撃した宝箱の硬さはA_{ij}だけ減る
- できるだけ少ない回数ですべての宝箱を開ける攻撃手段を求めよ

## 時間

- 4 時間

## 個人的メモ

### 武器の性質

#### 攻撃力 A_{ij} の生成方法

- 武器の攻撃力Aの生成方法が以下のようになっているため、小さい値が多く、いくつか大きい値があるような感じになる
  - A_{ij} \= round( 500/rand_double(1,500) )
- 硬さH_iは最大でも500なので、武器での攻撃が、効率がよい

#### 攻撃力が低い宝箱に武器を使わない

- 攻撃力が1桁しかでないような宝箱に武器を使うのはかなり効率が悪いため、ある程度大きな値になっているもの以外はできるだけ使いたくない
- あえてその武器を使わずに、素手や他の武器で攻撃して、効率の良い宝箱に使ったほうがよい可能性がある

#### オーバーキルがあり得る

- A_{ij} と H_j の間には制約条件がないため、A_{ij} > H_j になる可能性がある
  - 硬さ200の宝箱に対して500で攻撃できる武器がありえる
- 2つ以上の武器が使えるときなどに、一番攻撃力のある武器を使わないほうがよい場合がありえる

### その他の重要な性質

#### 最初に開ける宝箱

- 最初に開ける宝箱は、武器を持たないため、素手で開ける必要がある

#### 武器の汎用性

- 残っている宝箱について、「複数の宝箱に強い攻撃力を持つ武器」と「特定の宝箱にだけ強い攻撃力を持つ武器」を持っていた場合、攻撃力というより、後者の割当方のほうが重要になる可能性がある
- (解説放送)
- 武器の強さを攻撃力ではなく、各宝箱に何%の攻撃ができるか、とその総和を評価値とするなどができる
  - 攻撃力をそのまま使わず、割合で扱う

#### 1つの宝箱にのみ攻撃するのがよい?

- 細かい部分は無視して、各宝箱について、攻撃できる最大攻撃力を出力して見てみると、30%ぐらいは1回攻撃で宝箱を開けられるが、残りの70%ぐらいは複数回攻撃が必要な模様
- また、次点の攻撃力が最大攻撃力より結構下がってしまうものも多いため、できるだけ同じ武器で同じ宝箱に攻撃するのが効率がよいみたい

#### できるだけ早く武器を集める

- 武器をできるだけ使いたいので、早く武器を集める方針が考えられる
- 開けやすい宝箱に対して優先度などを評価値として考慮するなど考えられる

### アプローチ

#### 貪欲

- (解説放送)
- 手持ちの武器で一番攻撃力のある宝箱に対して攻撃する、を繰り返す、などいくつか貪欲が考えられる
- しかし、途中状態での評価が難しく、最後の方で素手中心の攻撃になるとひどいスコアになり得る
  - が、貪欲で上位に入っている人もいた模様
  - 解説放送では貪欲解での強い方法が紹介されている

#### 訪問順を焼きなまし

- 宝箱の訪問順を状態として持って、その順番に宝箱を手持ちの武器で攻撃する
  - 訪問順を1点move,2点swapなどの近傍で変化させる
  - スコアは、実際にシミュレーションして計算できる
- やってみると、制限時間2秒だと十分な探索ができていないようで、時間を伸ばすとスコアが伸びることがわかる
  - 高速化や攻撃戦略などのチューニングの余地がある

#### 攻撃先(DAG)を焼きなまし

- 各武器でどの宝箱を攻撃するか？を考えると、DAGならば(サイクルがないならば)、トポロジカルソートして訪問順が決まる
- この場合、スコアの計算は、攻撃先の変化した宝箱だけを見て差分計算できるため、O(1)で行える
  - DAGかの判定にはO(N)かかるが、DAGかの判定を受理判定後に行うことで、判定回数を減らせるため、探索回数が稼げる
    - (受理判定の部分は、状態に更新がなかった場合なども区別してちゃんと更新があった場合のみ判定する)
- また、各武器で攻撃力が高い宝箱の上位何件かから選ぶようにしたり、同じ武器で同じ宝箱を何度も攻撃しやすくする、などの工夫をいれるとかなりスコアが伸びる
- (細かいメモ)
  - 自分自身は攻撃先に選ばないようにする
  - 本番では「訪問順＆攻撃先を状態に持って焼きなまし」でやったが、そこから攻撃の仕方の方向ではなく、訪問順が不要＆差分更新、の方向に行ければよかった

### その他

#### 元ネタ

- (解説放送)
  - [某アクションゲーム](https://ja.wikipedia.org/wiki/%E3%83%AD%E3%83%83%E3%82%AF%E3%83%9E%E3%83%B3%E3%82%B7%E3%83%AA%E3%83%BC%E3%82%BA)

## 解説

- [AHCラジオ(解説放送)](https://www.youtube.com/watch?v=cJugLprYNFs)
  - [解説スライド](https://img.atcoder.jp/ahc055/bfe4019f6f59063cba6ed9e04052ab4b.pdf)
- [解説(日本語)](https://atcoder.jp/contests/ahc055/editorial)
- [解説(英語)](https://atcoder.jp/contests/ahc055/editorial?editorialLang=en)


- [writer](https://x.com/tomerun/status/1979913448764187079)
  - https://x.com/tomerun/status/1979919554005414063
  - https://x.com/tomerun/status/1979921456789180615


- [montplusaさん](https://x.com/montplusa/status/1981030835298947235)
- [HBitさん](https://x.com/toomerhs/status/1979911987770302501)
  - https://x.com/toomerhs/status/1979921002298475006
  - https://x.com/toomerhs/status/1979928500627710347
  - https://x.com/toomerhs/status/1980265418230280571
- [FplusFplusFさん](https://x.com/FplusFplusF____/status/1979913601986011175)
- [hiro116sさん](https://x.com/hiro116s/status/1979911853229977878)
- [twins_fuyuさん](https://x.com/Fuyu348867/status/1979916994267742276)
- [Shun_PIさん](https://x.com/Shun___PI/status/1979910918977843626)
  - https://x.com/Shun___PI/status/1979911824112787790
  - https://x.com/Shun___PI/status/1979913126909767847
  - https://x.com/Shun___PI/status/1979915343708471696
  - https://x.com/Shun___PI/status/1979923798523572375
  - https://x.com/Shun___PI/status/1979926448350560499
- [fuppy0716さん](https://x.com/fuppy_kyopro/status/1979912969140990307)
  - https://x.com/fuppy_kyopro/status/1979918976223178764
- [Piiiiiさん](https://x.com/AcPiiiii/status/1979913522390741066)
- [saharanさん](https://x.com/shr_pc/status/1979912932830883907)
  - https://x.com/shr_pc/status/1979914581519593979
- [miiitomiさん](https://x.com/miiitomi/status/1979918941192335582)
  - https://x.com/miiitomi/status/1980215241238872323
  - https://atcoder.jp/contests/ahc055/editorial/14266
- [bresoさん](https://x.com/Carbon_so6/status/1979913039274033211)
- [rhooさん](https://x.com/rho__o/status/1979914240816296163)
- [terry_u16さん](https://x.com/terry_u16/status/1979911383975174219)
  - https://x.com/terry_u16/status/1979912941118865694
  - https://x.com/terry_u16/status/1979914232889258321
- [hirakuuuuさん](https://x.com/hirakuuuuuuu/status/1979924387127316645)
- [noimiさん](https://x.com/noimi_kyopro/status/1979910873369153561)
  - https://x.com/noimi_kyopro/status/1979910936765886511
  - https://x.com/noimi_kyopro/status/1979911684161503491
  - https://x.com/noimi_kyopro/status/1979912235087495478
  - https://x.com/noimi_kyopro/status/1979915569227796690
  - https://x.com/noimi_kyopro/status/1979919379992129731
  - https://x.com/noimi_kyopro/status/1979919469666357551
- [besukohuさん](https://x.com/besukohu/status/1979912542894821617)
- [aotyamさん](https://x.com/aotyam_composit/status/1979917008750751918)
- [risujirohさん](https://x.com/risujiroh/status/1979913296426717396)
- [yokozuna57さん](https://x.com/yokozuna_57/status/1979911779632177482)
- [itigoさん](https://x.com/itigo_purokonn/status/1979911591375380652)
- [nurupo0723さん](https://x.com/nurupo1530/status/1979912016077701487)
  - https://note.com/nurupo0723/n/n9dff4dd66b7b
- [semiexpさん](https://x.com/semiexp/status/1979910770675827086)
  - https://x.com/semiexp/status/1979912608594502010
  - https://x.com/semiexp/status/1979913073298444470
- [kaz_mightyさん](https://x.com/kaz_mighty/status/1979912790656668103)
- [nouka28さん](https://x.com/nouka28/status/1979914220113215901)
- [keroruさん](https://x.com/keroru10/status/1979911450647785926)
  - https://x.com/keroru10/status/1979913013907063073
  - https://x.com/keroru10/status/1979913509279302030
  - https://x.com/keroru10/status/1979914145815273534
  - https://x.com/keroru10/status/1979915699737825755
- [tmbさん](https://x.com/tombo_ac/status/1979913388030415148)
  - https://tombo-ac.hatenablog.com/entry/2025/10/20/015545
- [tempura0224さん](https://x.com/tempuracpp/status/1979911748627894396)
  - https://x.com/tempuracpp/status/1979912994604687400
- [toamさん](https://x.com/torii_kyopro/status/1979910818318737416)
- [MathGorillaさん](https://x.com/MathGorilla_cp/status/1979913594327216227)
  - https://x.com/MathGorilla_cp/status/1979913938641858988
- [takumi152さん](https://x.com/takumi152/status/1979913834342060159)

## Links

- [twitter hashtag AHC055](https://x.com/hashtag/AHC055)
- [twitter search AHC055](https://x.com/search?q=AHC055)
- [twitter hashtag rcl_procon](https://x.com/hashtag/rcl_procon)
